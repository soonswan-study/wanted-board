#!/usr/bin/env sh

localRef=""
remoteRef=""
while read local_ref local_oid remote_ref remote_oid
  do
    localRef=$local_ref
    remoteRef=$remote_ref
  done

branch="$(git rev-parse --abbrev-ref HEAD)"

# src í´ë”ì— ë³€ê²½ëœ .js/.ts íŒŒì¼ì´ ìˆì„ ë•Œë§Œ ê²€ì¦ ì‹¤í–‰
if [ "$(git diff --name-only HEAD origin/main src/ | grep -E '\.(js|ts)$' | xargs | wc -l)" -ne 0 ]
then
  echo "ğŸ” ESLint ê²€ì‚¬ ì‹œì‘..."
  npm run lint
  if [ $? -ne 0 ]; then
    echo "âŒ ESLint ì˜¤ë¥˜ê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. pushê°€ ì¤‘ë‹¨ë©ë‹ˆë‹¤."
    exit 1
  fi
  echo "âœ… ESLint ê²€ì‚¬ í†µê³¼"
  
  echo "ğŸ§ª E2E í…ŒìŠ¤íŠ¸ ì‹œì‘..."
  npm run test:e2e
  if [ $? -ne 0 ]; then
    echo "âŒ E2E í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. pushê°€ ì¤‘ë‹¨ë©ë‹ˆë‹¤."
    exit 1
  fi
  echo "âœ… E2E í…ŒìŠ¤íŠ¸ í†µê³¼"
fi 